my_dataset_splits:
  _name: $EXEMPLES.SurnamesDatasetMLP
  data_file: $HOME/surnames/surnames_with_splits.csv
  batch_size: 128
  vectorizer:
    _name: $EXEMPLES.SurnamesVectorizerMLP
    data_file: $HOME/surnames/surnames_with_splits.csv

model:
  _name: $EXEMPLES.MultiLayerPerceptron
  hidden_dim: 100
  data: $my_dataset_splits

optimizer:
  _name: torch.optim.adam.Adam
  lr: 0.01
  params:
    _name: transfer_nlp.plugins.helpers.TrainableParameters

scheduler:
  _name: torch.optim.lr_scheduler.ReduceLROnPlateau
  patience: 1
  mode: min
  factor: 0.5

trainer:
  _name: transfer_nlp.plugins.trainers.SingleTaskTrainer
  model: $model
  dataset_splits: $my_dataset_splits
  loss:
    _name: torch.nn.modules.loss.CrossEntropyLoss
  optimizer: $optimizer
  gradient_clipping: 0.25
  num_epochs: 5
  seed: 1337
  regularizer:
    _name: transfer_nlp.plugins.regularizers.L1
  tensorboard_logs: $HOME/surnames/tensorboard/mlp
  metrics:
    accuracy:
      _name: ignite.metrics.accuracy.Accuracy
    loss:
      _name: transfer_nlp.plugins.metrics.LossMetric
      loss_fn:
        _name: torch.nn.modules.loss.CrossEntropyLoss

predictor:
  _name: $EXEMPLES.MLPPredictor
  data: $my_dataset_splits
  model: $model